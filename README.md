# Claude Code Monitor 🔍

一个用于监控Mac上所有Claude Code会话和TodoWrite状态的实时监控工具。

## 功能特性

- 🔍 **全局监控**：自动扫描并监控所有Claude Code会话
- 📝 **TodoWrite追踪**：实时显示每个会话的TodoWrite任务状态
- 🟢 **活跃状态**：识别活跃和非活跃会话
- 📊 **统计面板**：显示会话总数、活跃数、任务进度等
- 🔄 **实时更新**：文件变化时自动更新显示
- 🎨 **美观界面**：使用Rich库构建的终端UI

## 安装和运行

### 方法1：使用启动脚本（推荐）

```bash
cd /Users/haya/Code/claude-monitor
./run.sh
```

### 方法2：手动运行

```bash
# 安装依赖
pip3 install -r requirements.txt

# 运行监控器
python3 claude_monitor.py
```

## 界面说明

监控界面分为以下几个部分：

1. **标题栏**：显示程序名称
2. **统计面板**：显示总会话数、活跃会话、TodoWrite项目数、待完成任务数
3. **会话列表**：
   - 🟢 活跃会话（30分钟内有活动）
   - 🔴 非活跃会话
   - 显示项目名、会话ID、持续时间、消息数、TodoWrite进度
4. **TodoWrite汇总**：
   - 任务统计（已完成/进行中/待处理）
   - 最新任务列表

## 监控原理

1. **数据源**：监控 `~/.claude/projects/` 目录下的所有 `.jsonl` 文件
2. **实时监控**：使用 watchdog 监听文件系统变化
3. **进程监控**：使用 psutil 监控 Claude 进程状态
4. **增量读取**：只读取文件新增内容，提高性能

## 快捷键

- `Ctrl+C`：退出程序

## 注意事项

- 首次启动时会扫描所有历史会话，可能需要几秒钟
- 会话文件较多时（1000+）可能会占用一定内存
- 建议在独立终端窗口中运行，以获得最佳显示效果

## 作者

哈雅 (263321)